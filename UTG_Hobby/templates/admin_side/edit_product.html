{% extends "admin_side/admin_base.html" %}
{% load static %}
{% block title %}Edit Product{% endblock %}
{% block content  %}

<main id="main" class="main">
  <div class="col-lg-12">
    <div class="card">
      <div class="card-body">
              <h5 class="card-title">Edit Products</h5>

              <!-- No Labels Form -->
              <form class="row g-3" id="editProductForm" action="{% url 'edit_product' id=product.id %}" method="POST">
                {% csrf_token %}
                <div class="col-md-12">
                  <input type="text" class="form-control" placeholder="Product Name" name="product_name" value={{product.products_name}} required>
                </div>

                <div class="col-12">
                  <input type="text" class="form-control" placeholder="Description" name="description" value={{product.description}} required>
                </div>

                <div class="col-md-12">
                  <select id="inputState" class="form-select" name='category' required>
                    {% for cat in category %}
                    <option value="{{cat.id}}" {% if cat.id == product.category_id.id %}selected{% endif %}>{{cat.name}}</option>
                    {% endfor %}
                  </select>
                </div>

                <div class="col-md-12">
                  <select id="inputState" class="form-select" name='brand' required>
                      {% for bran in brand %}
                          <option value="{{bran.id}}" {% if bran.id == product.brand_id.id %}selected{% endif %}>
                              {{bran.name}}
                          </option>
                      {% endfor %}
                  </select>
              </div>
              {% if messages %}
                <div class=" alert text-danger" id='alert-message' >  
                {% for message in messages %}
                {{ message }}
                {% endfor %}
                </div>
                {% endif %}

                <div class="text-center">
                  <button type="submit" class="btn btn-primary">Submit</button>
                </div>
              </form><!-- End No Labels Form -->

            </div>
          </div>
        </div>
        <script>
          function hideAlert() {
            var alertMessage = document.getElementById('alert-message');
            if (alertMessage) {
                setTimeout(function() {
                    alertMessage.style.display = 'none';
                }, 2000); 
            }
        }
        window.onload = hideAlert;
        </script>

<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<script src="https://cdn.jsdelivr.net/jquery.validation/1.16.0/jquery.validate.min.js"></script>

<script>
  $(document).ready(function() {
    $("#editProductForm").validate({
      rules: {
        product_name: {
          required: true,
          minlength: 2,
          noConsecutiveSpaces: true
        },
      },
      messages: {
        product_name: {
          required: "Please enter the product name",
          minlength: "Product name must be at least 2 characters long",
          noConsecutiveSpaces: "Product name cannot contain more than 2 consecutive spaces"
        },
      },
      errorClass: "is-invalid",
      errorPlacement: function(error, element) {
        error.addClass("invalid-feedback");
        error.insertAfter(element);
      }
    });

    // Custom validation method
    $.validator.addMethod("noConsecutiveSpaces", function(value, element) {
      return !/\s{2,}/.test(value);
    }, "Product name cannot contain more than 2 consecutive spaces");
  });
</script>

          {% endblock %}
